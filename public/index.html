<button class="btn-small btn-reject" onclick="decide(${p.id}, 'rejected')">‚úï –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                document.getElementById('postsList').innerHTML = '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
            }
        }

        async function decide(id, status) {
            try {
                await fetch(`${API_URL}/posts/decide`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({id, decision: status})
                });
                document.getElementById(`post-${id}`).classList.add('approved');
                showToast(status === 'approved' ? '‚úÖ –û–¥–æ–±—Ä–µ–Ω–æ' : '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ');
                setTimeout(loadPosts, 500);
                loadStats();
            } catch (e) {
                showToast('–û—à–∏–±–∫–∞');
            }
        }

        async function loadSources() {
            try {
                const r = await fetch(`${API_URL}/sources`);
                const d = await r.json();
                
                document.getElementById('sourcesList').innerHTML = d.data.map(s => `
                    <div class="source-item">
                        <div class="source-icon">üì°</div>
                        <div class="source-info">
                            <div class="source-name">${s.username}</div>
                            <div class="source-meta">${s.category} ‚Ä¢ ${s.is_active ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–í—ã–∫–ª—é—á–µ–Ω'}</div>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" ${s.is_active ? 'checked' : ''}>
                            <span class="slider"></span>
                        </label>
                    </div>
                `).join('');
                
                document.getElementById('statSources').textContent = d.data.length;
            } catch (e) {}
        }

        function showAddSource() {
            document.getElementById('addSourceForm').style.display = 'block';
        }

        function hideAddSource() {
            document.getElementById('addSourceForm').style.display = 'none';
        }

        async function addSource() {
            const u = document.getElementById('newUsername').value;
            const c = document.getElementById('newCategory').value;
            
            if (!u) return showToast('–í–≤–µ–¥–∏—Ç–µ username');
            
            try {
                await fetch(`${API_URL}/sources`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({username: u, category: c})
                });
                showToast('‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ');
                hideAddSource();
                loadSources();
            } catch (e) {
                showToast('–û—à–∏–±–∫–∞');
            }
        }

        // –°—Ç–∞—Ä—Ç
        loadStats();
        loadPosts();
        setInterval(loadStats, 10000);
    </script>
</body>
</html>
